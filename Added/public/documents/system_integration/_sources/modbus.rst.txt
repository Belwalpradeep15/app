MODBUS
======
The MODBUS interface is an optional component that is available with a Panoptes system.
This component allows a Panoptes system to interface with a SCADA system using
the MODBUS protocol via either TCP or a serial port. By default a Panoptes does not come with the MODBUS interface enabled,
and configuring it can be a significant
amount of work. While the customer can do this themselves, typically it is done in cooperation with our field engineers.

**Advantages**

SCADA is a common standard in the engineering fields where Panoptes is likely to be used. And very often
a customer that has a SCADA system will not be interested in our Panoptes UI but would rather that the appropriate
sirens sound, symbols change on their panels, and so on. The MODBUS component is how this is accomplished.

Unlike the WebSocket, XML and Email interfaces (which output messages in a format that
your systems will need to interpret), the MODBUS protocol is well defined and should work out of the box with any
suitable MODBUS based system. All that is required is that we agree on the meaning of the various coils and registers.

**Disadvantages**

The first disadvantage is that the MODBUS interface doesn't provide a lot of information. It provides the
existence of alarms (i.e. either there is an alarm condition or there is not) and it can provide simple information limited to
unsigned integers. At present the fibre position or the OnRoute position in metres is all we provide. By
contrast the XML protocol provides a significant amount of information on each alarm, including types, geo-spatial
coordinates, custom tag information, and acknowledgement and resolution history. None of this is available via the
MODBUS protocol.

The second
disadvantage is that the MODBUS component is somewhat complex to configure. Additionally the SCADA side can be
complex and expensive to write, but that is generally not too much of a concern as the customers who would be
interested in this ability will generally already have a system with which they want our system to communicate.

Another disadvantage is that it requires that your system regularly poll the system. (As opposed to the WebSocket,
XML and Email interfaces that push information to your system at the appropriate times.) This means that either the
system will need a small polling interval, which can have an adverse affect on your overall network traffic, or it must deal
with information that is not necessarily up to date (if you have a large polling interval).

Capabilities
------------
Here is a brief overview of the capabilities of the MODBUS system.

Showing the existence of an alarm
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Basically, if an alarm can be viewed on the Panoptes portal interface, then it can be communicated via the MODBUS
protocol. Specifically, the existence of an alarm is mapped to a MODBUS coil. Examples of alarms available include:

* Alarms based on events on the fibre (e.g. “digging”, “vehicle movement”, “fibre break”, etc.)
* Health of a Panoptes unit
* Health of a Helios unit
* Loss of communications
* High cabinet temperatures

A coil is one of the object types available in MODBUS. It is 1-bit and can represent a boolean.
The coil is set, when the alarm exists. And the coil is cleared, when the alarm doesn't exist.

Showing an attribute of an alarm
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
In addition to the coils used to note the existence of an alarm, MODBUS registers can be set according to a value
associated with an alarm. Examples of alarm values available include:

* Position of the alarm along the fibre, measured in metres.
* Position of the alarm along a route, measured in metres.

A register is one of the object types available in MODBUS. It is 16-bit and can only handle unsigned integers.

This key limitation means that only values from 0 to 65535 can be represented in the register.
If necessary, a 32 bit unsigned integer
can be decomposed into it’s high-order word (first 16 bits) and low-order word (last 16 bits), and stored in two
neighbouring registers. This way, we can represent values greater than 65535.

Filtering of Alarms
^^^^^^^^^^^^^^^^^^^
Both the coils (alarm existence) and registers (alarm value) can be filtered based on various properties of the alarm.
For example, the customer probably doesn’t want to flag a MODBUS coil whenever a Helios has a problem, more likely
they would want to assign a coil to each Helios unit. Example of properties used for alarm filtering include:

* Type of alarm (e.g. “helios” vs. “fibre_break_event”, etc.)
* Helios unit
* Fibre line (useful for MUXing systems where a single Helios unit may have more than one fibre)
* Position based region on the fibre (e.g. “a leak has occurred near pump #3”)

Configuring
-----------
Configuring the MODBUS interface is somewhat more complex than the other interfaces. In particular there is no
graphical interface for this configuration. Instead an appropriate XML file must be created and put into place.

Please refer to the "Panoptes_MODBUS_Example.pdf" for and elaborate example of the setup procedure.